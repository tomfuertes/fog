"use strict";var Fog=(()=>{var p=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var k=(e,t)=>{for(var n in t)p(e,n,{get:t[n],enumerable:!0})},L=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of b(t))!h.call(e,o)&&o!==n&&p(e,o,{get:()=>t[o],enumerable:!(a=w(t,o))||a.enumerable});return e};var S=e=>L(p({},"__esModule",{value:!0}),e);var O={};k(O,{getStatus:()=>x,getVariant:()=>y,init:()=>R,isEnabled:()=>D,page:()=>v,reset:()=>_,track:()=>g});var u="",l="",c={},r="pending",d=null,m=null;function x(){return r}function _(){u="",l="",c={},r="pending",m=null,d&&(d(),d=null)}function T(){if(typeof window>"u")return()=>{};let e=window;e.dataLayer||(e.dataLayer=[]);let t=e.dataLayer,n=t.push.bind(t);return t.push=(...a)=>{for(let o of a)if(o.event==="purchase"){let i=o.ecommerce,s=typeof i?.value=="number"?i.value:void 0;for(let I of Object.keys(c))g("conversion",{experimentId:I,value:s})}return n(...a)},()=>{t.push=n}}function f(e,t){typeof navigator<"u"&&navigator.sendBeacon?navigator.sendBeacon(e,new Blob([t],{type:"application/json"})):fetch(e,{method:"POST",body:t,headers:{"Content-Type":"application/json"}}).catch(()=>{})}async function R(e){u=e.endpoint,r="pending";let t=e.timeout??5e3,n=new AbortController,a=setTimeout(()=>n.abort(),t),o=e.visitorId?`${e.endpoint}/init?visitorId=${encodeURIComponent(e.visitorId)}`:`${e.endpoint}/init`;try{let i=await fetch(o,{signal:n.signal});if(clearTimeout(a),!i.ok)return r="error",{status:"error",error:`HTTP ${i.status}`};let s=await i.json();return l=s.visitorId,c=s.assignments,r=Object.keys(s.assignments).length===0?"excluded":"ready",e.autoRevenue&&r==="ready"&&(d=T()),{status:r}}catch(i){clearTimeout(a);let s=i instanceof Error&&i.name==="AbortError";return r="error",{status:"error",error:s?"timeout":String(i)}}}function y(e){return r!=="ready"?-1:c[e]??-1}function D(e){return y(e)===1}function g(e,t){r==="ready"&&f(u+"/track",JSON.stringify({visitorId:l,experimentId:t.experimentId,event:e,eventName:t.eventName,value:t.value}))}function v(e){let t=m??(r==="ready"?u:null);if(!t)return;let n=e??(typeof window<"u"?window.location.pathname:"/");f(t+"/track",JSON.stringify({event:"pageview",experimentId:"",eventName:n}))}if(typeof document<"u"){let e=document.currentScript;if(e?.src){let t=e.src;m=t.endsWith("/t.js")?t.slice(0,-5):t.replace(/\/[^/]*$/,"");let n=()=>v(window.location.pathname+window.location.search);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n,{once:!0}):n()}}return S(O);})();
